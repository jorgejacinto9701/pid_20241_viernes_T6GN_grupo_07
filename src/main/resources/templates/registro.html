<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
	<meta charset="utf-8">
	    <title>Registro Jefe Prestamista</title>
	    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
	        integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
</head>
<body>
	<div class="container">
	        <h2 class="mt-5">Registra un Jefe de Prestamistas</h2>
	        <form action="/registro/jefePrestamista" method="post" id="registroForm">
	            <div class="mb-3">
	                <label for="nombre_jp" class="form-label">Nombre:</label>
	                <input type="text" class="form-control" id="nombre_jp" name="nombre_jp" required>
	            </div>
	            <div class="mb-3">
	                <label for="apellido_jp" class="form-label">Apellido:</label>
	                <input type="text" class="form-control" id="apellido_jp" name="apellido_jp" required>
	            </div>
	            <div class="mb-3">
	                <label for="correo_jp" class="form-label">Correo electrónico:</label>
	                <input type="email" class="form-control" id="correo_jp" name="correo_jp" required>
	            </div>
				<div class="mb-3">
					  <label for="dni_jp" class="form-label">Dni:</label>
					  <input type="number" class="form-control" id="dni_jp" name="dni_jp" required>
				</div>
	            <div class="mb-3">
	                <label for="telefono_jp" class="form-label">Teléfono:</label>
	                <input type="tel" class="form-control" id="telefono_jp" name="telefono_jp" required>
	            </div>
				<div class="mb-3">
					 <label for="contrasenia_jp" class="form-label">Nuevo Paswword:</label>
					<input type="text" class="form-control" id="contrasenia_jp" name="contrasenia_jp" required>
				</div>
				<div class="mb-4">
					<label for="nacimiento_jp" class="form-label">Fecha de Nacimiento:</label>
					<input type="date" class="form-control" id="nacimiento_jp" name="nacimiento_jp" required>
				</div>
				<div class="mb-3">
				    <label for="id_distrito" class="form-label">Distrito a Cargo:</label>
				    <select class="form-select" id="id_distrito" name="distrito.id_distrito" required>
				        <option value="">[Seleccione]</option>
				    </select>
				</div>
				<button type="submit" class="btn btn-primary">Registrar</button>
	        </form>
	    </div>
    </form>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script type="text/javascript">
	    $(document).ready(function() {
	        $.getJSON("/registro/distritos", {}, function(data) {
	            $.each(data, function(index, item) {
	                $("#id_distrito").append("<option value=" + item.id_distrito + ">" + item.nombre_disrtito + "</option>");
	            });
	        }).fail(function(jqXHR, textStatus, errorThrown) {
	            console.error("Error al cargar los distritos: " + textStatus, errorThrown);
	        });
	    });
	</script>
	<script>
	    $(document).ready(function() {
			
			function formatearFecha(fecha) {
			            var partes = fecha.split('/');
			            return partes[2] + '-' + partes[1] + '-' + partes[0];
			        }
			
	        $('#registroForm').submit(function(event) {
	            // Evitar que se envíe el formulario de manera predeterminada
	            event.preventDefault();

	            // Obtener los datos del formulario
	            var formData = {
	                nombre_jp: $('#nombre_jp').val(),
					apellido_jp: $('#apellido_jp').val(),
					correo_jp: $('#correo_jp').val(),
					dni_jp: $('#dni_jp').val(),
					telefono_jp: $('#telefono_jp').val(),
					contrasenia_jp: $('#contrasenia_jp').val(),
					nacimiento_jp: $('#nacimiento_jp').val(),
					id_distrito: $('#id_distrito').val(),
	            };
				
				console.log(formData);
	
	            // Enviar los datos del formulario al backend
	            $.ajax({
	                type: 'POST',
	                url: '/registro/jefePrestamista',
	                data: JSON.stringify(formData),
	                contentType: 'application/json',
	                success: function(response) {
	                    // Manejar la respuesta del backend, por ejemplo, mostrar un mensaje de éxito
	                    alert('Jefe de Prestamistas registrado correctamente');
	                },
	                error: function(xhr, status, error) {
	                    // Manejar errores, por ejemplo, mostrar un mensaje de error
	                    alert('Error al registrar el Jefe de Prestamistas');
	                    console.error(xhr.responseText);
	                }
	            });
	        });
	    });
	</script>
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
	        integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
	        crossorigin="anonymous">
	</script>
</body>
</html>

